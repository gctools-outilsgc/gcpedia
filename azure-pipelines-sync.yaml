trigger:
- main

pool:
  vmImage: ubuntu-latest

steps:
- script: |
    echo Sync azure repo
    B64_PAT=$(echo -n ":$PAT" | base64)
    git clone --bare https://GCTools:$SYSTEM_ACCESSTOKEN@dev.azure.com/tbs-sct/GCTools/_git/$REPO_NAME Sync_directory
    cd Sync_directory
    git remote add --mirror=fetch upstream https://github.com/gctools-outilsgc/$REPO_NAME
    git fetch upstream --tags
    git push origin --all
  env:
    PAT: $(PAT)
    SYSTEM_ACCESSTOKEN: $(System.AccessToken)
    REPO_NAME: "gcpedia"
  uses:
   repositories:
     - gcpedia
  displayName: 'Sync repo'
